compsci-cluster-fitz-29
Sun Apr  6 10:23:14 PM EDT 2025
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr localhost --master_port 2012 ./finetune.py --base-path . --model-path gpt2-xl --ckpt-name gpt2-xlarge --n-gpu 4 --data-dir ./processed_data/bugnet_python/full/gpt2/ --num-workers 0 --dev-num 1000 --lr 0.00005 --batch-size 2 --eval-batch-size 4 --gradient-accumulation-steps 1 --warmup-iters 0 --lr-decay-style cosine --weight-decay 1e-2 --clip-grad 1.0 --epochs 10 --max-length 512 --max-prompt-length 256 --do-train --do-valid --eval-gen --save-interval 4000 --eval-interval 4000 --log-interval 4 --mid-log-num 10 --save ./results/gpt2/train/sft/gpt2-xlarge/ --seed 10 --seed-order 10 --deepspeed --deepspeed_config ./configs/deepspeed/ds_config_zero1_fp16.json --type lm --do-sample --top-k 0 --top-p 1.0 --temperature 1.0
PYTHONPATH=.
W0406 22:23:19.320000 226133 torch/distributed/run.py:792] 
W0406 22:23:19.320000 226133 torch/distributed/run.py:792] *****************************************
W0406 22:23:19.320000 226133 torch/distributed/run.py:792] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0406 22:23:19.320000 226133 torch/distributed/run.py:792] *****************************************
[2025-04-06 22:23:24,752] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-04-06 22:23:24,752] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-04-06 22:23:24,755] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-04-06 22:23:24,757] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Warning: The cache directory for DeepSpeed Triton autotune, /home/users/ap794/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
Warning: The cache directory for DeepSpeed Triton autotune, /home/users/ap794/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
Warning: The cache directory for DeepSpeed Triton autotune, /home/users/ap794/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
Warning: The cache directory for DeepSpeed Triton autotune, /home/users/ap794/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
using world size: 4
[2025-04-06 22:23:32,793] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-04-06 22:23:32,794] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
arguments:
  model_path ................... gpt2-xl
  ckpt_name .................... gpt2-xlarge
  model_type ................... gpt2
  teacher_model_type ........... None
  n_gpu ........................ 4
  n_nodes ...................... 1
  teacher_model_path ........... None
  teacher_ckpt_name ............ None
  teacher_model_fp16 ........... False
  model_parallel ............... False
  model_parallel_size .......... None
  no_value ..................... False
  dropout_path_rate ............ None
  dtype ........................ torch.float16
  type ......................... lm
  do_train ..................... True
  do_valid ..................... True
  do_eval ...................... False
  base_path .................... .
  load ......................... None
  save ......................... ./results/gpt2/train/sft/gpt2-xlarge/e10-bs2-lr5e-05-G1-N4-NN1
  log_interval ................. 4
  mid_log_num .................. 10
  save_interval ................ 4000
  eval_interval ................ 4000
  local_rank ................... 0
  save_additional_suffix ....... 
  save_rollout ................. False
  eb_sample_times .............. 3
  data_dir ..................... ./processed_data/bugnet_python/full/gpt2/
  processed_data_dir ........... None
  force_process ................ False
  force_process_demo ........... False
  data_process_workers ......... -1
  train_num .................... -1
  train_ratio .................. 1
  dev_num ...................... 1000
  dev_ratio .................... 1
  gen_num ...................... -1
  data_names ................... None
  prompt_type .................. None
  num_workers .................. 0
  max_prompt_length ............ 256
  min_prompt_length ............ 128
  json_data .................... False
  bin_data ..................... False
  txt_data ..................... False
  prompt_data_dir .............. None
  lm_data_dir .................. None
  eval_ppl ..................... False
  eval_rw ...................... False
  eval_gen ..................... True
  only_prompt .................. False
  batch_size ................... 2
  eval_batch_size .............. 4
  clip_grad .................... 1.0
  total_iters .................. None
  train_iters_per_epoch ........ -1
  max_length ................... 512
  seed ......................... 10
  seed_order ................... 10
  seed_data .................... 42
  seed_ppo ..................... 42
  seed_lm ...................... 7
  epochs ....................... 10
  training_epochs .............. 10000
  gradient_accumulation_steps .. 1
  gradient_checkpointing ....... False
  attn_dtype ................... None
  lr ........................... 5e-05
  lr_min ....................... 1e-07
  weight_decay ................. 0.01
  loss_scale ................... 65536
  kd_ratio ..................... None
  warmup_iters ................. 0
  lr_decay_iters ............... None
  lr_decay_style ............... cosine
  scheduler_name ............... constant_trm
  reward_scaling ............... None
  cliprange_reward ............. 1
  ppo_epochs ................... None
  num_rollouts ................. 256
  num_rollouts_per_device ...... None
  cliprange .................... 0.2
  chunk_size ................... None
  gamma ........................ 0.95
  length_norm .................. False
  single_step_reg .............. False
  teacher_mixed_alpha .......... None
  lm_coef ...................... 1
  top_k ........................ 0
  top_p ........................ 1.0
  do_sample .................... True
  no_repeat_ngram_size ......... 6
  repetition_penalty ........... None
  num_beams .................... 1
  temperature .................. 1.0
  peft ......................... None
  peft_lora_r .................. 8
  peft_lora_alpha .............. 32
  peft_lora_dropout ............ 0.1
  peft_name .................... None
  peft_path .................... None
  teacher_peft_name ............ None
  teacher_peft_path ............ None
  deepspeed .................... True
  deepspeed_config ............. ./configs/deepspeed/ds_config_zero1_fp16.json
  deepscale .................... False
  deepscale_config ............. None
  rank ......................... 0
  world_size ................... 4
[2025-04-06 22:23:33,036] [INFO] [comm.py:658:init_distributed] cdb=None
Sun Apr  6 22:23:32 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   24C    P8             20W /  230W |       4MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   25C    P2             21W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   22C    P2             18W /  230W |      25MiB /  23028MiB |      1%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   21C    P2             12W /  230W |      25MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3         52MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3         18MiB |
+-----------------------------------------------------------------------------------------+

[2025-04-06 22:23:33,381] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-04-06 22:23:33,391] [INFO] [comm.py:658:init_distributed] cdb=None
Sun Apr  6 22:23:33 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   24C    P8             21W /  230W |       4MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   26C    P2             30W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   23C    P2             27W /  230W |     209MiB /  23028MiB |      1%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   21C    P2             22W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3        202MiB |
+-----------------------------------------------------------------------------------------+

Sun Apr  6 22:23:33 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   24C    P8             22W /  230W |       4MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   26C    P2             34W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   23C    P2             32W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   22C    P2             28W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3        202MiB |
+-----------------------------------------------------------------------------------------+

Sun Apr  6 22:23:33 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   24C    P8             22W /  230W |       4MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   26C    P2             51W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   23C    P2             32W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   22C    P2             44W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3        202MiB |
+-----------------------------------------------------------------------------------------+

Sun Apr  6 22:23:33 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   24C    P8             22W /  230W |       4MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   26C    P2             34W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   23C    P2             32W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   22C    P2             28W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3        202MiB |
+-----------------------------------------------------------------------------------------+

Sun Apr  6 22:23:33 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   24C    P8             22W /  230W |       4MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   26C    P2             58W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   23C    P2             57W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   22C    P2             52W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3        202MiB |
+-----------------------------------------------------------------------------------------+

Probing Dataset
Probing end. Max data state 1, total length 1693
1693
Num LM instances: 1693
train num 1693
Probing Dataset
Probing end. Max data state 1, total length 596
596
Num LM instances: 596
Train iters per epoch 211
total_iters 2110
Sun Apr  6 22:23:35 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   24C    P8             21W /  230W |       4MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   26C    P2             60W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   23C    P2             57W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   22C    P2             52W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3        202MiB |
+-----------------------------------------------------------------------------------------+
Sun Apr  6 22:23:35 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   24C    P8             21W /  230W |       4MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   26C    P2             60W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   23C    P2             57W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   22C    P2             52W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3        202MiB |
+-----------------------------------------------------------------------------------------+


Sun Apr  6 22:23:35 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   24C    P8             21W /  230W |       4MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   26C    P2             60W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   23C    P2             57W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   22C    P2             52W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3        202MiB |
+-----------------------------------------------------------------------------------------+

Sun Apr  6 22:23:36 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   24C    P8             20W /  230W |       4MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   26C    P2             60W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   23C    P2             57W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   22C    P2             52W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3        202MiB |
+-----------------------------------------------------------------------------------------+

Sun Apr  6 22:23:36 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   24C    P8             20W /  230W |       4MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   26C    P2             60W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   23C    P2             57W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   22C    P2             52W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3        202MiB |
+-----------------------------------------------------------------------------------------+

Sun Apr  6 22:23:36 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   24C    P8             20W /  230W |       4MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   26C    P2             60W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   23C    P2             57W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   22C    P2             52W /  230W |     209MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3        202MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3        202MiB |
+-----------------------------------------------------------------------------------------+

[2025-04-06 22:23:50,960] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 4
[2025-04-06 22:23:51,002] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 4
[2025-04-06 22:23:51,045] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 4
 > number of parameters: 1557611200
Model load time: 15.228686809539795s
Optimizer = AdamW
[2025-04-06 22:23:51,679] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-04-06 22:23:51,680] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 4
[2025-04-06 22:23:52,537] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2025-04-06 22:23:52,539] [INFO] [logging.py:128:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2025-04-06 22:23:52,539] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-04-06 22:23:52,676] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = AdamW
[2025-04-06 22:23:52,676] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=AdamW type=<class 'torch.optim.adamw.AdamW'>
[2025-04-06 22:23:52,676] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float32 ZeRO stage 1 optimizer
[2025-04-06 22:23:52,676] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-04-06 22:23:52,676] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-04-06 22:23:52,677] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-04-06 22:23:52,677] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-04-06 22:24:09,049] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-04-06 22:24:09,050] [INFO] [utils.py:782:see_memory_usage] MA 7.3 GB         Max_MA 7.3 GB         CA 7.32 GB         Max_CA 7 GB 
[2025-04-06 22:24:09,050] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 26.36 GB, percent = 2.6%
[2025-04-06 22:24:09,282] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-04-06 22:24:09,283] [INFO] [utils.py:782:see_memory_usage] MA 7.3 GB         Max_MA 8.75 GB         CA 8.77 GB         Max_CA 9 GB 
[2025-04-06 22:24:09,283] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 24.56 GB, percent = 2.4%
[2025-04-06 22:24:09,283] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-04-06 22:24:09,415] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-04-06 22:24:09,416] [INFO] [utils.py:782:see_memory_usage] MA 7.3 GB         Max_MA 7.3 GB         CA 8.77 GB         Max_CA 9 GB 
[2025-04-06 22:24:09,417] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 24.56 GB, percent = 2.4%
[2025-04-06 22:24:09,421] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-04-06 22:24:09,421] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2025-04-06 22:24:09,421] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = <torch.optim.lr_scheduler.CosineAnnealingLR object at 0x7f38e1406cb0>
[2025-04-06 22:24:09,421] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[5e-05, 5e-05], mom=[(0.9, 0.999), (0.9, 0.999)]
[2025-04-06 22:24:09,423] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-04-06 22:24:09,423] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-04-06 22:24:09,424] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-04-06 22:24:09,424] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-04-06 22:24:09,424] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-04-06 22:24:09,424] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-04-06 22:24:09,424] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-04-06 22:24:09,424] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-04-06 22:24:09,425] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-04-06 22:24:09,425] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-04-06 22:24:09,425] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-04-06 22:24:09,425] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f38e4025bd0>
[2025-04-06 22:24:09,425] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-04-06 22:24:09,425] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-04-06 22:24:09,425] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-04-06 22:24:09,425] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-04-06 22:24:09,425] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-04-06 22:24:09,425] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-04-06 22:24:09,426] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-04-06 22:24:09,426] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-04-06 22:24:09,426] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-04-06 22:24:09,426] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... None
[2025-04-06 22:24:09,426] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-04-06 22:24:09,426] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-04-06 22:24:09,426] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-04-06 22:24:09,426] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-04-06 22:24:09,426] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-04-06 22:24:09,426] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-04-06 22:24:09,427] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-04-06 22:24:09,427] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-04-06 22:24:09,427] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-04-06 22:24:09,427] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-04-06 22:24:09,427] [INFO] [config.py:1005:print]   fp16_auto_cast ............... None
[2025-04-06 22:24:09,427] [INFO] [config.py:1005:print]   fp16_enabled ................. False
[2025-04-06 22:24:09,427] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-04-06 22:24:09,427] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-04-06 22:24:09,427] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-04-06 22:24:09,427] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-04-06 22:24:09,428] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-04-06 22:24:09,428] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-04-06 22:24:09,428] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-04-06 22:24:09,428] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-04-06 22:24:09,428] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-04-06 22:24:09,428] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-04-06 22:24:09,428] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-04-06 22:24:09,428] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-04-06 22:24:09,428] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-04-06 22:24:09,428] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-04-06 22:24:09,429] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-04-06 22:24:09,429] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-04-06 22:24:09,429] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-04-06 22:24:09,429] [INFO] [config.py:1005:print]   optimizer_name ............... None
[2025-04-06 22:24:09,429] [INFO] [config.py:1005:print]   optimizer_params ............. None
[2025-04-06 22:24:09,429] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-04-06 22:24:09,429] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-04-06 22:24:09,429] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-04-06 22:24:09,429] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-04-06 22:24:09,430] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-04-06 22:24:09,430] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-04-06 22:24:09,430] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-04-06 22:24:09,430] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-04-06 22:24:09,430] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-04-06 22:24:09,430] [INFO] [config.py:1005:print]   steps_per_print .............. 10000000
[2025-04-06 22:24:09,430] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-04-06 22:24:09,430] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-04-06 22:24:09,430] [INFO] [config.py:1005:print]   train_batch_size ............. 8
[2025-04-06 22:24:09,430] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  2
[2025-04-06 22:24:09,431] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-04-06 22:24:09,431] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-04-06 22:24:09,431] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-04-06 22:24:09,431] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-04-06 22:24:09,431] [INFO] [config.py:1005:print]   world_size ................... 4
[2025-04-06 22:24:09,431] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  True
[2025-04-06 22:24:09,431] [INFO] [config.py:1005:print]   zero_config .................. stage=1 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-04-06 22:24:09,431] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-04-06 22:24:09,431] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-04-06 22:24:09,432] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 1
[2025-04-06 22:24:09,432] [INFO] [config.py:991:print_user_config]   json = {
    "train_micro_batch_size_per_gpu": 2, 
    "gradient_accumulation_steps": 1, 
    "zero_optimization": {
        "stage": 1
    }, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": false, 
        "loss_scale": 0, 
        "initial_scale_power": 11, 
        "loss_scale_window": 2.000000e+03, 
        "hysteresis": 4
    }, 
    "wall_clock_breakdown": false, 
    "gradient_clipping": 1.0, 
    "steps_per_print": 1.000000e+07
}
Model mem
 |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   7475 MiB |   7475 MiB |  15037 MiB |   7562 MiB |
|       from large pool |   7426 MiB |   7426 MiB |  14983 MiB |   7557 MiB |
|       from small pool |     48 MiB |     48 MiB |     54 MiB |      5 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   7475 MiB |   7475 MiB |  15037 MiB |   7562 MiB |
|       from large pool |   7426 MiB |   7426 MiB |  14983 MiB |   7557 MiB |
|       from small pool |     48 MiB |     48 MiB |     54 MiB |      5 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   7475 MiB |   7475 MiB |  14902 MiB |   7427 MiB |
|       from large pool |   7426 MiB |   7426 MiB |  14848 MiB |   7422 MiB |
|       from small pool |     48 MiB |     48 MiB |     53 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8982 MiB |   8982 MiB |  15072 MiB |   6090 MiB |
|       from large pool |   8930 MiB |   8930 MiB |  15018 MiB |   6088 MiB |
|       from small pool |     52 MiB |     52 MiB |     54 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  21198 KiB |  21198 KiB | 563427 KiB | 542229 KiB |
|       from large pool |  18104 KiB |  18104 KiB | 527487 KiB | 509382 KiB |
|       from small pool |   3093 KiB |   3093 KiB |  35940 KiB |  32847 KiB |
|---------------------------------------------------------------------------|
| Allocations           |     100    |     100    |    1262    |    1162    |
|       from large pool |       3    |       3    |     198    |     195    |
|       from small pool |      97    |      97    |    1064    |     967    |
|---------------------------------------------------------------------------|
| Active allocs         |     100    |     100    |    1262    |    1162    |
|       from large pool |       3    |       3    |     198    |     195    |
|       from small pool |      97    |      97    |    1064    |     967    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      30    |     201    |     171    |
|       from large pool |       4    |       4    |     174    |     170    |
|       from small pool |      26    |      26    |      27    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |       5    |     231    |     226    |
|       from large pool |       2    |       2    |      53    |      51    |
|       from small pool |       3    |       3    |     178    |     175    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Start Fine-tuning
Sun Apr  6 22:24:08 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   29C    P2             62W /  230W |    7855MiB /  23028MiB |      3%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   30C    P2             59W /  230W |    7837MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   27C    P2             57W /  230W |    9341MiB /  23028MiB |      3%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   25C    P2             53W /  230W |    6351MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    226137      C   ...project_distillLLM/venv/bin/python3       7848MiB |
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3       7828MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3       6344MiB |
+-----------------------------------------------------------------------------------------+

Sun Apr  6 22:24:09 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   29C    P2             62W /  230W |    9341MiB /  23028MiB |      1%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   30C    P2             60W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   27C    P2             58W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   25C    P2             53W /  230W |    9341MiB /  23028MiB |      1%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    226137      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3       9334MiB |
+-----------------------------------------------------------------------------------------+

Sun Apr  6 22:24:09 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   29C    P2             63W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   30C    P2             60W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   27C    P2             58W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   26C    P2             53W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    226137      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3       9334MiB |
+-----------------------------------------------------------------------------------------+

Sun Apr  6 22:24:09 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   29C    P2             62W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   30C    P2             61W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   27C    P2             58W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   26C    P2             53W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    226137      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3       9334MiB |
+-----------------------------------------------------------------------------------------+

Start Fine-tuning
Sun Apr  6 22:24:10 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   29C    P2             62W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   30C    P2             61W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   27C    P2             58W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   26C    P2             53W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    226137      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3       9334MiB |
+-----------------------------------------------------------------------------------------+

Sun Apr  6 22:24:10 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   29C    P2             62W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   30C    P2             61W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   27C    P2             58W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   26C    P2             53W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    226137      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3       9334MiB |
+-----------------------------------------------------------------------------------------+

Sun Apr  6 22:24:10 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   29C    P2             62W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   30C    P2             61W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   27C    P2             58W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   26C    P2             53W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    226137      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3       9336MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3       9334MiB |
+-----------------------------------------------------------------------------------------+

Sun Apr  6 22:24:10 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   29C    P2             62W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   30C    P2             61W /  230W |    9343MiB /  23028MiB |      1%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   27C    P2             57W /  230W |    9343MiB /  23028MiB |      1%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   26C    P2             53W /  230W |    9341MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    226137      C   ...project_distillLLM/venv/bin/python3       9334MiB |
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3       9336MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3       9336MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3       9334MiB |
+-----------------------------------------------------------------------------------------+

dp size 4
0/63
1/63
2/63
3/63
4/63
5/63
6/63
7/63
8/63
9/63
10/63
11/63
12/63
13/63
14/63
15/63
Evaluating:   0%|          | 0/63 [00:00<?, ?it/s]Evaluating:   2%|         | 1/63 [00:19<20:35, 19.92s/it]Evaluating:   3%|         | 2/63 [00:39<19:47, 19.46s/it]Evaluating:   5%|         | 3/63 [00:58<19:16, 19.27s/it]Evaluating:   6%|         | 4/63 [01:17<18:53, 19.22s/it]Evaluating:   8%|         | 5/63 [01:36<18:32, 19.18s/it]Evaluating:  10%|         | 6/63 [01:55<18:11, 19.14s/it]Evaluating:  11%|         | 7/63 [02:14<17:50, 19.12s/it]Evaluating:  13%|        | 8/63 [02:33<17:30, 19.10s/it]Evaluating:  14%|        | 9/63 [02:52<17:10, 19.09s/it]Evaluating:  16%|        | 10/63 [03:11<16:51, 19.08s/it]Evaluating:  17%|        | 11/63 [03:30<16:31, 19.07s/it]Evaluating:  19%|        | 12/63 [03:49<16:12, 19.08s/it]Evaluating:  21%|        | 13/63 [04:08<15:54, 19.09s/it]Evaluating:  22%|       | 14/63 [04:28<15:36, 19.11s/it]Evaluating:  24%|       | 15/63 [04:47<15:17, 19.11s/it]Evaluating:  25%|     16/63
17/63
18/63
19/63
20/63
21/63
22/63
23/63
24/63
25/63
26/63
27/63
28/63
29/63
30/63
  | 16/63 [05:06<14:58, 19.11s/it]Evaluating:  27%|       | 17/63 [05:25<14:38, 19.10s/it]Evaluating:  29%|       | 18/63 [05:44<14:19, 19.09s/it]Evaluating:  30%|       | 19/63 [06:02<13:51, 18.89s/it]Evaluating:  32%|      | 20/63 [06:22<13:35, 18.97s/it]Evaluating:  33%|      | 21/63 [06:41<13:18, 19.02s/it]Evaluating:  35%|      | 22/63 [07:00<12:59, 19.02s/it]Evaluating:  37%|      | 23/63 [07:19<12:42, 19.06s/it]Evaluating:  38%|      | 24/63 [07:38<12:23, 19.07s/it]Evaluating:  40%|      | 25/63 [07:57<12:05, 19.08s/it]Evaluating:  41%|     | 26/63 [08:16<11:46, 19.11s/it]Evaluating:  43%|     | 27/63 [08:35<11:28, 19.13s/it]Evaluating:  44%|     | 28/63 [08:54<11:09, 19.11s/it]Evaluating:  46%|     | 29/63 [09:14<10:50, 19.12s/it]Evaluating:  48%|     | 30/63 [09:33<10:30, 19.12s/it]Evaluating:  49%| 31/63
32/63
33/63
34/63
35/63
36/63
Distributed index stop interation. Idx: 598 Total_length: 596
Distributed index stop interation. Idx: 597 Total_length: 596
Distributed index stop interation. Idx: 599 Total_length: 596
Distributed index stop interation. Idx: 596 Total_length: 596
    | 31/63 [09:52<10:11, 19.11s/it]Evaluating:  51%|     | 32/63 [10:11<09:52, 19.11s/it]Evaluating:  52%|    | 33/63 [10:30<09:32, 19.10s/it]Evaluating:  54%|    | 34/63 [10:49<09:14, 19.10s/it]Evaluating:  56%|    | 35/63 [11:08<08:55, 19.12s/it]Evaluating:  57%|    | 36/63 [11:27<08:35, 19.10s/it]Evaluating:  59%|    | 37/63 [11:46<08:16, 19.08s/it]Evaluating:  59%|    | 37/63 [11:46<08:16, 19.10s/it]
Sun Apr  6 22:35:58 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   42C    P2            108W /  230W |   12665MiB /  23028MiB |     67%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   45C    P2            108W /  230W |   12665MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   42C    P2            107W /  230W |   12665MiB /  23028MiB |     21%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   38C    P2             99W /  230W |   12665MiB /  23028MiB |     52%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    226137      C   ...project_distillLLM/venv/bin/python3      12658MiB |
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3      12658MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3      12658MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3      12658MiB |
+-----------------------------------------------------------------------------------------+

Sun Apr  6 22:35:58 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   42C    P2            108W /  230W |   12665MiB /  23028MiB |     67%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   45C    P2            108W /  230W |   12665MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   42C    P2            107W /  230W |   12665MiB /  23028MiB |     21%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   38C    P2             99W /  230W |   12665MiB /  23028MiB |     52%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    226137      C   ...project_distillLLM/venv/bin/python3      12658MiB |
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3      12658MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3      12658MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3      12658MiB |
+-----------------------------------------------------------------------------------------+

Sun Apr  6 22:35:58 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   42C    P2            108W /  230W |   12665MiB /  23028MiB |     67%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   45C    P2            108W /  230W |   12665MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   42C    P2            107W /  230W |   12665MiB /  23028MiB |     21%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   38C    P2             99W /  230W |   12665MiB /  23028MiB |     52%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    226137      C   ...project_distillLLM/venv/bin/python3      12658MiB |
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3      12658MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3      12658MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3      12658MiB |
+-----------------------------------------------------------------------------------------+

./results/gpt2/train/sft/gpt2-xlarge/e10-bs2-lr5e-05-G1-N4-NN1/eval/0
dev | avg_loss: 2.0389120449890963 | {'exact_match': 0.0, 'rougeL': 5.9842}
Sun Apr  6 22:36:00 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:17:00.0 Off |                    0 |
| 30%   41C    P2             78W /  230W |   12665MiB /  23028MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA RTX A5000               Off |   00000000:31:00.0 Off |                    0 |
| 30%   50C    P2            197W /  230W |   21943MiB /  23028MiB |    100%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA RTX A5000               Off |   00000000:B1:00.0 Off |                    0 |
| 30%   46C    P2            197W /  230W |   22041MiB /  23028MiB |    100%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA RTX A5000               Off |   00000000:CA:00.0 Off |                    0 |
| 30%   42C    P2            200W /  230W |   21403MiB /  23028MiB |     95%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    226137      C   ...project_distillLLM/venv/bin/python3      12658MiB |
|    1   N/A  N/A    226138      C   ...project_distillLLM/venv/bin/python3      21896MiB |
|    2   N/A  N/A    226139      C   ...project_distillLLM/venv/bin/python3      21876MiB |
|    3   N/A  N/A    226140      C   ...project_distillLLM/venv/bin/python3      21296MiB |
+-----------------------------------------------------------------------------------------+

train | epoch   0 | Iter:      1/  2110 | global iter:      1/  2110 | loss: 2.0153 | ds_loss: 0.0000 | lr: 5.0000e-05 | scale:     1.0000 | micro time: 2.885 | step time: 0.000
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/users/ap794/final_project_distillLLM/minillm/./finetune.py", line 560, in <module>
[rank0]:     main()
[rank0]:   File "/home/users/ap794/final_project_distillLLM/minillm/./finetune.py", line 553, in main
[rank0]:     model = finetune(args, tokenizer, model, optimizer, lr_scheduler, dataset, device, teacher_model=teacher_model)
[rank0]:   File "/home/users/ap794/final_project_distillLLM/minillm/./finetune.py", line 279, in finetune
[rank0]:     model.backward(loss)
[rank0]:   File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/deepspeed/utils/nvtx.py", line 18, in wrapped_fn
[rank0]:     ret_val = func(*args, **kwargs)
[rank0]:   File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/deepspeed/runtime/engine.py", line 2126, in backward
[rank0]:     self.optimizer.backward(loss, retain_graph=retain_graph)
[rank0]:   File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 2067, in backward
[rank0]:     self.loss_scaler.backward(loss.float(), retain_graph=retain_graph)
[rank0]:   File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/deepspeed/runtime/fp16/loss_scaler.py", line 63, in backward
[rank0]:     scaled_loss.backward(retain_graph=retain_graph)
[rank0]:   File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/torch/_tensor.py", line 626, in backward
[rank0]:     torch.autograd.backward(
[rank0]:   File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/torch/autograd/__init__.py", line 347, in backward
[rank0]:     _engine_run_backward(
[rank0]:   File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
[rank0]:     return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank0]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 308.00 MiB. GPU 0 has a total capacity of 22.18 GiB of which 253.44 MiB is free. Including non-PyTorch memory, this process has 21.93 GiB memory in use. Of the allocated memory 20.87 GiB is allocated by PyTorch, and 694.62 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[rank3]: Traceback (most recent call last):
[rank3]:   File "/home/users/ap794/final_project_distillLLM/minillm/./finetune.py", line 560, in <module>
[rank3]:     main()
[rank3]:   File "/home/users/ap794/final_project_distillLLM/minillm/./finetune.py", line 553, in main
[rank3]:     model = finetune(args, tokenizer, model, optimizer, lr_scheduler, dataset, device, teacher_model=teacher_model)
[rank3]:   File "/home/users/ap794/final_project_distillLLM/minillm/./finetune.py", line 279, in finetune
[rank3]:     model.backward(loss)
[rank3]:   File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/deepspeed/utils/nvtx.py", line 18, in wrapped_fn
[rank3]:     ret_val = func(*args, **kwargs)
[rank3]:   File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/deepspeed/runtime/engine.py", line 2126, in backward
[rank3]:     self.optimizer.backward(loss, retain_graph=retain_graph)
[rank3]:   File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 2067, in backward
[rank3]:     self.loss_scaler.backward(loss.float(), retain_graph=retain_graph)
[rank3]:   File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/deepspeed/runtime/fp16/loss_scaler.py", line 63, in backward
[rank3]:     scaled_loss.backward(retain_graph=retain_graph)
[rank3]:   File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/torch/_tensor.py", line 626, in backward
[rank3]:     torch.autograd.backward(
[rank3]:   File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/torch/autograd/__init__.py", line 347, in backward
[rank3]:     _engine_run_backward(
[rank3]:   File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
[rank3]:     return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank3]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 308.00 MiB. GPU 3 has a total capacity of 22.18 GiB of which 243.44 MiB is free. Including non-PyTorch memory, this process has 21.94 GiB memory in use. Of the allocated memory 20.87 GiB is allocated by PyTorch, and 704.00 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[rank0]:[W406 22:36:05.125367413 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
W0406 22:36:07.021000 226133 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 226137 closing signal SIGTERM
W0406 22:36:07.023000 226133 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 226138 closing signal SIGTERM
W0406 22:36:07.023000 226133 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 226139 closing signal SIGTERM
E0406 22:36:07.453000 226133 torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: 1) local_rank: 3 (pid: 226140) of binary: /home/users/ap794/final_project_distillLLM/venv/bin/python3
Traceback (most recent call last):
  File "/home/users/ap794/final_project_distillLLM/venv/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/torch/distributed/run.py", line 918, in main
    run(args)
  File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/torch/distributed/run.py", line 909, in run
    elastic_launch(
  File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/users/ap794/final_project_distillLLM/venv/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 269, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
./finetune.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-04-06_22:36:07
  host      : compsci-cluster-fitz-29.cs.duke.edu.
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 226140)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
srun: error: compsci-cluster-fitz-29: task 0: Exited with exit code 1
